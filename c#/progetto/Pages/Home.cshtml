@page
@model progetto.Pages.HomeModel
@{
    ViewData["Title"] = "Search Books";
}
<h1>Home</h1>

<form id="searchForm">
    <div>
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" />
    </div>
    <div>
        <label for="author">Author:</label>
        <input type="text" id="author" name="author" />
    </div>
    <div>
        <label for="genre">Genre:</label>
        <input type="text" id="genre" name="genre" />
    </div>
    <button type="button" onclick="searchBooks()">Search</button>
</form>

<div id="results"></div>

@section Scripts {
    <script>
        async function searchBooks() {
            const title = document.getElementById('title').value;
            const author = document.getElementById('author').value;
            const genre = document.getElementById('genre').value;

            const response = await fetch(`/api/book/search?title=${title}&author=${author}&genre=${genre}`);
            const books = await response.json();

            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            if (books.length === 0) {
                resultsDiv.innerHTML = '<p>No books found.</p>';
            } else {
                const ul = document.createElement('ul');
                books.forEach(book => {
                    const li = document.createElement('li');
                    li.textContent = `${book.title} by ${book.authorCF} (Genre: ${book.genre})`;
                    ul.appendChild(li);
                });
                resultsDiv.appendChild(ul);
            }
        }
    </script>
}